#!/usr/bin/env bash
set -euo pipefail

session_name="${1:-devops}"
workspace_dir="${2:-$HOME/work}"

mkdir -p "$workspace_dir"

if tmux has-session -t "$session_name" 2>/dev/null; then
  exec tmux attach -t "$session_name"
fi

tmux new-session -d -s "$session_name" -n shell -c "$workspace_dir"

tmux send-keys -t "$session_name:shell" 'clear' C-m

tmux split-window -h -t "$session_name:shell" -l 48 "~/.local/bin/tmx-cheatsheet"
tmux select-pane -t "$session_name:shell" -L

tmux select-window -t "$session_name:shell"
exec tmux attach -t "$session_name"
